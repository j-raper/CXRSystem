;/*FB_PKG_DELIM*/

__d("MWV2CreatePromptMenuItemQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="23937200145924592"}),null);
__d("MWV2CreatePromptMenuItemQuery.graphql",["MWV2CreatePromptMenuItemQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"Literal",name:"surface_nux_id",value:10706},{kind:"Literal",name:"trigger",value:"COMMUNITY_MESSAGING_PROMPT"}],c=[{kind:"Literal",name:"supported",value:"TDHjT"}],d={kind:"InlineFragment",selections:[{args:null,documentName:"MWV2CreatePromptMenuItemQuery",fragmentName:"CometQuickPromotionMessengerWebPromptsNuxDialogRendererStrategy_quickPromotionRef",fragmentPropName:"quickPromotionRef",kind:"ModuleImport"}],type:"CometQuickPromotionMessengerWebPromptsRendererStrategy",abstractKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWV2CreatePromptMenuItemQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"ViewerEligibleQuickPromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"CometQuickPromotionSections",kind:"LinkedField",name:"comet_qp_sections",plural:!1,selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"renderer_strategy",plural:!1,selections:[d],storageKey:'renderer_strategy(supported:"TDHjT")'}],storageKey:null}],storageKey:null}],storageKey:'eligible_promotions(surface_nux_id:10706,trigger:"COMMUNITY_MESSAGING_PROMPT")'}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MWV2CreatePromptMenuItemQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"ViewerEligibleQuickPromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"CometQuickPromotionSections",kind:"LinkedField",name:"comet_qp_sections",plural:!1,selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"renderer_strategy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d],storageKey:'renderer_strategy(supported:"TDHjT")'}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:'eligible_promotions(surface_nux_id:10706,trigger:"COMMUNITY_MESSAGING_PROMPT")'}],storageKey:null}]},params:{id:b("MWV2CreatePromptMenuItemQuery_facebookRelayOperation"),metadata:{},name:"MWV2CreatePromptMenuItemQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("AudioClipsBrowserBlockMicAccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("73");b=d("FalcoLoggerInternal").create("audio_clips_browser_block_mic_access",a);e=b;g["default"]=e}),98);
__d("AudioClipsCancelledByUserFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("39");b=d("FalcoLoggerInternal").create("audio_clips_cancelled_by_user",a);e=b;g["default"]=e}),98);
__d("AudioClipsDialogNotnowMicAccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("74");b=d("FalcoLoggerInternal").create("audio_clips_dialog_notnow_mic_access",a);e=b;g["default"]=e}),98);
__d("AudioClipsDialogOkMicAccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("75");b=d("FalcoLoggerInternal").create("audio_clips_dialog_ok_mic_access",a);e=b;g["default"]=e}),98);
__d("AudioClipsMicAccessCheckFailedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("76");b=d("FalcoLoggerInternal").create("audio_clips_mic_access_check_failed",a);e=b;g["default"]=e}),98);
__d("AudioClipsPlaybackPauseFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("44");b=d("FalcoLoggerInternal").create("audio_clips_playback_pause",a);e=b;g["default"]=e}),98);
__d("AudioClipsPlaybackResumeFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("45");b=d("FalcoLoggerInternal").create("audio_clips_playback_resume",a);e=b;g["default"]=e}),98);
__d("AudioClipsPlaybackStartFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("47");b=d("FalcoLoggerInternal").create("audio_clips_playback_start",a);e=b;g["default"]=e}),98);
__d("AudioClipsStartRecordingClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("51");b=d("FalcoLoggerInternal").create("audio_clips_start_recording_click",a);e=b;g["default"]=e}),98);
__d("AudioClipsStopRecordingClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("52");b=d("FalcoLoggerInternal").create("audio_clips_stop_recording_click",a);e=b;g["default"]=e}),98);
__d("Ls1lcFeatureOpenFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("153");b=d("FalcoLoggerInternal").create("ls_1lc_feature_open",a);e=b;g["default"]=e}),98);
__d("MWChatAudioLog",["AudioClipsBrowserBlockMicAccessFalcoEvent","AudioClipsCancelledByUserFalcoEvent","AudioClipsDialogNotnowMicAccessFalcoEvent","AudioClipsDialogOkMicAccessFalcoEvent","AudioClipsMicAccessCheckFailedFalcoEvent","AudioClipsPlaybackPauseFalcoEvent","AudioClipsPlaybackResumeFalcoEvent","AudioClipsPlaybackStartFalcoEvent","AudioClipsStartRecordingClickFalcoEvent","AudioClipsStopRecordingClickFalcoEvent","I64","Ls1lcFeatureOpenFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){c("AudioClipsStopRecordingClickFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:(h||(h=d("I64"))).to_string(h.of_float(a)),entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:"true",position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function b(){c("AudioClipsStartRecordingClickFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:void 0,entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}}),c("Ls1lcFeatureOpenFalcoEvent").log(function(){return{extra:void 0,feature:13,feature_sessionid:void 0,screen_orientation:void 0,stage:7,thread:void 0}})}function e(){c("AudioClipsCancelledByUserFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:void 0,entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function f(){c("AudioClipsBrowserBlockMicAccessFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:void 0,entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function i(a){c("AudioClipsPlaybackStartFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:(h||(h=d("I64"))).to_string(h.of_float(a)),entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function j(a,b){c("AudioClipsPlaybackPauseFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:(h||(h=d("I64"))).to_string(h.of_float(a)),entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:h.to_string(h.of_float(b)),relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function k(a,b){c("AudioClipsPlaybackResumeFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:(h||(h=d("I64"))).to_string(h.of_float(a)),entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:h.to_string(h.of_float(b)),relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function l(){c("AudioClipsDialogOkMicAccessFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:void 0,entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function m(){c("AudioClipsDialogNotnowMicAccessFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:void 0,entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}function n(){c("AudioClipsMicAccessCheckFailedFalcoEvent").log(function(){return{attachment_id:void 0,connection_quality:void 0,duration:void 0,entry_point:void 0,error_code:void 0,error_message:void 0,has_access_token:void 0,is_prefetch:void 0,position:void 0,relative_url_path:void 0,rtc_call_type:void 0,source_click_category:2,with_captions:void 0}})}g.logClickStopRecording=a;g.logClickStartRecording=b;g.logDeleteRecording=e;g.logBrowserDenyAccess=f;g.logPlaybackStart=i;g.logPlaybackPause=j;g.logPlaybackResume=k;g.logDialogOk=l;g.logDialogNotNow=m;g.logMicAccessCheckFailed=n}),98);
__d("LSIssueRestoreTask",["LSAppendDataTraceAddon","LSIsMobileClient","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueRestoreTaskStoredProcedure] Beginning execution."),c.i64.eq(a[3],c.i64.cast([0,1]))?d[1]="messages":d[1]="threads",d[14]=["Restoring ",d[1]].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueRestoreTaskStoredProcedure] ","",d[14]].join("")),c.resolve()},function(d){return a[5]!==f?c.sp(b("LSAppendDataTraceAddon"),a[5],c.i64.cast([0,3604]),c.i64.cast([0,2]),f,f):c.resolve()},function(a){return c.sp(b("LSIsMobileClient")).then(function(a){return a=a,d[2]=a[0],a})},function(a){return d[2]?d[3]=!0:d[3]=!1,d[3]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[18]=c.createArray(),f!==f?d[19]=(d[18].push(f),d[18]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[18],c.i64.cast([0,3]))):c.resolve()},function(e){return a[9]!==f?d[4]=a[9]:d[4]="",c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[18]=c.i64.of_float(Date.now()),d[5]=c.i64.add(d[18],c.i64.cast([0,0]))):d[5]=c.i64.cast([0,0]),c.sp(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",":",d[4]].join(""),c.i64.cast([0,50015]),"",f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,d[5],c.i64.cast([0,0])).then(function(a){return a=a,d[6]=a[0],a})},function(d){return a[5]!==f?c.sp(b("LSAppendDataTraceAddon"),a[5],c.i64.cast([0,3601]),c.i64.cast([0,2]),f,f):c.resolve()},function(a){return c.sp(b("LSIsMobileClient")).then(function(a){return a=a,d[7]=a[0],a})},function(a){return d[7]?d[8]=!0:d[8]=!1,d[8]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[18]=c.createArray(),f!==f?d[19]=(d[18].push(f),d[18]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[18],c.i64.cast([0,3]))):c.resolve()},function(b){return c.db.table(190).add({taskId:d[6],mailboxPartialId:a[0],listId:a[1],numItems:a[2],contentType:a[3],startSortKey:a[4],traceId:a[5],isPointQuery:!1,newerNumItems:a[7],unencryptedSortKey:a[8],serverThreadKey:a[9],waThreadId:a[10]})},function(d){return a[5]!==f?c.sp(b("LSAppendDataTraceAddon"),a[5],c.i64.cast([0,3605]),c.i64.cast([0,2]),f,f):c.resolve()},function(a){return c.sp(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[18]=c.createArray(),f!==f?d[19]=(d[18].push(f),d[18]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[18],c.i64.cast([0,3]))):c.resolve()},function(a){return d[11]=c.i64.of_float(Date.now()),d[12]=c.i64.random(),d[15]="Finishing execution. Execution time: ",d[16]=c.i64.to_string(c.i64.sub(d[11],d[0])),d[17]=" ms",d[13]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueRestoreTaskStoredProcedure] ",d[13],d[15],d[13],d[16],d[13],d[17]].join("")),c.i64.eq(c.i64.mod_(d[12],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[18]=",",d[19]=c.createArray(),f!==f?d[20]=(d[19].push(f),d[19]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueRestoreTaskStoredProcedure",[d[15],d[18],d[16],d[18],d[17]].join(""),d[19],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[6]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSIssueMessageRangeQueryTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSBinaryToHex.nop","LSCreateDataTrace","LSCreateDataTraceID.nop","LSCreateDerivedKeys.nop","LSFlushDataTrace.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSGetThreadTransportIdFromThreadId.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewTask","LSIssueRestoreTask","LSLoadThreadPkFromThreadId","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop","gkx","justknobx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1];d.n;var e=[],f=[],g;return d.seq([function(f){return d.seq([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] Beginning execution."),!a[3]&&!0?(e[9]=d.i64.gt(a[1],d.i64.cast([0,0]))&&d.i64.gt(a[5],d.i64.cast([0,0])),d.islc(d.ftr(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))||!1}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(c,f){var h=c.done;c=c.value;return h?d.seq([function(c){return e[9]?(e[12]=new d.Map(),e[12].set("error_code",d.i64.cast([0,1])),e[12].set("error_message",""),e[12].set("stored_procedure","issueMessageRangeQueryTask"),e[13]=new d.Map(),e[13].set("act_thread_id",a[0]),e[14]=new d.Map(),e[14].set("restore_context",e[13]),e[14].set("failure",e[12]),e[15]=e[14].get("restore_context"),e[14],e[16]=e[15].get("act_thread_id"),e[15],e[17]=d.toJSON(e[14]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[16]].join(""),d.i64.cast([0,50031]),e[17],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0]))):(e[12]=new d.Map(),e[12].set("error_code",d.i64.cast([0,1])),e[12].set("error_message",""),e[12].set("stored_procedure","issueMessageRangeQueryTask"),e[13]=new d.Map(),e[13].set("act_thread_id",a[0]),e[13].set("source",g),e[13].set("restore_operation_type",d.i64.cast([0,2])),e[14]=new d.Map(),e[14].set("restore_context",e[13]),e[14].set("failure",e[12]),e[15]=e[14].get("restore_context"),e[14],e[16]=e[15].get("act_thread_id"),e[15],e[17]=d.toJSON(e[14]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[16]].join(""),d.i64.cast([0,50030]),e[17],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0])))},function(c){return e[11]="backup not found",e[11]!==g?d.seq([function(c){return e[15]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",e[11]].join(""),function(a){d.logger(a).mustfix(a)}(e[15]),e[12]=d.createArray(),a[4]!==g?e[16]=(e[12].push(a[4]),e[12]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",e[11],e[12],d.i64.cast([0,3]))},function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),e[15],g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[16]=a[0],a})},function(a){return e[16]?e[17]=!0:e[17]=!1,e[17]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[18]=d.createArray(),g!==g?e[19]=(e[18].push(g),e[18]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[18],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[13]=a[0],a})},function(a){return e[13]?e[14]=!0:e[14]=!1,e[14]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[16]=d.createArray(),g!==g?e[17]=(e[16].push(g),e[16]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[16],d.i64.cast([0,3]))):d.resolve()}]):d.seq([function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[14]=a[0],a})},function(a){return e[14]?e[15]=!0:e[15]=!1,e[15]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[16]=d.createArray(),g!==g?e[17]=(e[16].push(g),e[16]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[16],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[12]=a[0],a})},function(a){return e[12]?e[13]=!0:e[13]=!1,e[13]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[14]=d.createArray(),g!==g?e[15]=(e[14].push(g),e[14]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[14],d.i64.cast([0,3]))):d.resolve()}])},function(a){return e[9]?e[10]=d.i64.cast([0,5]):e[10]=d.i64.cast([0,2]),e[7]=!1}]):(f=c.item,d.seq([function(a){return e[18]=f.mailboxRootKeyBlob,e[17]=f.ocmfClientStateBlob,e[16]=f.deviceId,e[15]=f.backupTenancy,e[14]=f.encryptionVersion,d.i64.neq(g,g)?d.resolve(e[10]=g):d.seq([function(a){return e[19]=d.createArray(),d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,0])).then(function(a){return a=a,e[20]=a[0],a})},function(a){return e[20]?e[29]=(e[19].push(d.i64.cast([0,0])),e[19]):0,d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,2])).then(function(a){return a=a,e[21]=a[0],a})},function(a){return e[21]?e[29]=(e[19].push(d.i64.cast([0,2])),e[19]):0,d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,3])).then(function(a){return a=a,e[22]=a[0],a})},function(a){return e[22]?e[29]=(e[19].push(d.i64.cast([0,3])),e[19]):0,d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,4])).then(function(a){return a=a,e[23]=a[0],a})},function(a){return e[23]?e[29]=(e[19].push(d.i64.cast([0,4])),e[19]):0,e[24]=d.createArray(),e[25]=d.i64.of_int32(e[19].length),d.i64.gt(e[25],d.i64.cast([0,0]))?d.loopAsync(e[25],function(a){return e[29]=a,d.seq([function(a){return d.ntop("Array",b("LSArrayGetObjectAt"),e[19],e[29]).then(function(a){return a=a,e[30]=a[0],e[31]=a[1],a})},function(a){return e[32]=(e[24].push(e[30]),e[24])}])}):d.resolve()},function(a){return d.seq([function(a){return e[29]=d.createArray(),e[30]=d.i64.of_int32(e[24].length),d.i64.gt(e[30],d.i64.cast([0,0]))?d.loopAsync(e[30],function(a){return e[32]=a,d.seq([function(a){return d.ntop("Array",b("LSArrayGetObjectAt"),e[24],e[32]).then(function(a){return a=a,e[33]=a[0],e[34]=a[1],a})},function(a){return e[35]=(e[29].push(d.i64.to_string(e[33])),e[29])}])}):d.resolve()},function(a){return e[31]=e[29].join(","),e[26]=e[31]}])},function(a){return e[24].some(function(a){return d.i64.eq(e[14],a)})?e[27]=e[14]:e[27]=g,d.i64.neq(e[27],g)?e[28]=e[27]:e[28]=g,e[10]=e[28]}])},function(c){return d.i64.neq(e[10],g)?e[11]=e[10]:e[11]=d.i64.cast([0,0]),d.i64.neq(e[15],g)?e[12]=e[15]:e[12]=d.i64.cast([0,1]),d.i64.neq(e[16],g)?d.seq([function(c){return d.sp(b("LSLoadThreadPkFromThreadId"),a[0]).then(function(a){return a=a,e[19]=a[0],e[20]=a[1],a})},function(c){return d.i64.neq(e[19],g)?e[9]?d.seq([function(c){return d.i64.eq(e[12],d.i64.cast([0,3]))?e[21]=d.i64.cast([0,4]):e[21]=d.i64.cast([0,0]),e[22]=new d.Map(),e[22].set("act_thread_id",a[0]),e[22].set("tam_thread_subtype",e[21]),d.nop(b("LSBase64Encode.nop"),e[17]).then(function(a){return a=a,e[23]=a[0],a})},function(a){return d.nop(b("LSBase64Encode.nop"),e[18]).then(function(a){return a=a,e[24]=a[0],a})},function(a){return e[25]=new d.Map(),e[25].set("ocmf_client_state_blob",e[23]==null?"":e[23]),e[25].set("mailbox_root_key",e[24]==null?"":e[24]),e[26]=d.createArray(),d.fe(d.ftr(d.db.table(169).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))}),function(a){a=a.item;return e[37]=(e[26].push(a.epochId),e[26])})},function(a){return e[35]="Queried locally available epochs. Count: ",e[27]=d.i64.of_int32(e[26].length),e[36]=d.i64.to_string(e[27]),e[28]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",e[28],e[35],e[28],e[36]].join("")),d.resolve()},function(c){return e[29]=new d.Map(),e[29].set("device_id",e[16]),e[29].set("raw_tokens",e[25]),e[29].set("locally_available_epochs",e[26]),e[30]=new d.Map(),e[30].set("reference_timestamp",a[2]),e[30].set("server_thread_key",g),e[30].set("device_context",e[29]),e[31]=new d.Map(),e[31].set("restore_context",e[22]),e[31].set("success",e[30]),e[32]=e[31].get("restore_context"),e[31],e[33]=e[32].get("act_thread_id"),e[32],e[34]=d.toJSON(e[31]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[33]].join(""),d.i64.cast([0,50031]),e[34],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0]))}]):d.i64.gt(a[1],d.i64.cast([0,0]))?d.seq([function(c){return d.i64.eq(e[12],d.i64.cast([0,3]))?e[21]=d.i64.cast([0,4]):e[21]=d.i64.cast([0,0]),e[22]=new d.Map(),e[22].set("act_thread_id",a[0]),e[22].set("request_id",a[4]),e[22].set("tam_thread_subtype",e[21]),d.nop(b("LSBase64Encode.nop"),e[17]).then(function(a){return a=a,e[23]=a[0],a})},function(a){return d.nop(b("LSBase64Encode.nop"),e[18]).then(function(a){return a=a,e[24]=a[0],a})},function(a){return e[25]=new d.Map(),e[25].set("ocmf_client_state_blob",e[23]==null?"":e[23]),e[25].set("mailbox_root_key",e[24]==null?"":e[24]),e[26]=d.createArray(),d.fe(d.ftr(d.db.table(169).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))}),function(a){a=a.item;return e[37]=(e[26].push(a.epochId),e[26])})},function(a){return e[35]="Queried locally available epochs. Count: ",e[27]=d.i64.of_int32(e[26].length),e[36]=d.i64.to_string(e[27]),e[28]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",e[28],e[35],e[28],e[36]].join("")),d.resolve()},function(c){return e[29]=new d.Map(),e[29].set("device_id",e[16]),e[29].set("raw_tokens",e[25]),e[29].set("locally_available_epochs",e[26]),e[30]=new d.Map(),e[30].set("reference_timestamp",a[2]),e[30].set("direction",d.i64.cast([0,1])),e[30].set("server_thread_key",g),e[30].set("device_context",e[29]),e[31]=new d.Map(),e[31].set("restore_context",e[22]),e[31].set("success",e[30]),e[32]=e[31].get("restore_context"),e[31],e[33]=e[32].get("act_thread_id"),e[32],e[34]=d.toJSON(e[31]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[33]].join(""),d.i64.cast([0,50030]),e[34],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0]))}]):d.seq([function(c){return d.i64.eq(e[12],d.i64.cast([0,3]))?e[21]=d.i64.cast([0,4]):e[21]=d.i64.cast([0,0]),e[22]=new d.Map(),e[22].set("act_thread_id",a[0]),e[22].set("request_id",a[4]),e[22].set("tam_thread_subtype",e[21]),d.nop(b("LSBase64Encode.nop"),e[17]).then(function(a){return a=a,e[23]=a[0],a})},function(a){return d.nop(b("LSBase64Encode.nop"),e[18]).then(function(a){return a=a,e[24]=a[0],a})},function(a){return e[25]=new d.Map(),e[25].set("ocmf_client_state_blob",e[23]==null?"":e[23]),e[25].set("mailbox_root_key",e[24]==null?"":e[24]),e[26]=d.createArray(),d.fe(d.ftr(d.db.table(169).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))}),function(a){a=a.item;return e[37]=(e[26].push(a.epochId),e[26])})},function(a){return e[35]="Queried locally available epochs. Count: ",e[27]=d.i64.of_int32(e[26].length),e[36]=d.i64.to_string(e[27]),e[28]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",e[28],e[35],e[28],e[36]].join("")),d.resolve()},function(c){return e[29]=new d.Map(),e[29].set("device_id",e[16]),e[29].set("raw_tokens",e[25]),e[29].set("locally_available_epochs",e[26]),e[30]=new d.Map(),e[30].set("reference_timestamp",a[2]),e[30].set("direction",d.i64.cast([0,2])),e[30].set("server_thread_key",g),e[30].set("device_context",e[29]),e[31]=new d.Map(),e[31].set("restore_context",e[22]),e[31].set("success",e[30]),e[32]=e[31].get("restore_context"),e[31],e[33]=e[32].get("act_thread_id"),e[32],e[34]=d.toJSON(e[31]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[33]].join(""),d.i64.cast([0,50030]),e[34],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0]))}]):d.seq([function(c){return e[9]?(e[23]=new d.Map(),e[23].set("error_code",d.i64.cast([0,100])),e[23].set("error_message",""),e[23].set("stored_procedure","issueMessageRangeQueryTask"),e[24]=new d.Map(),e[24].set("act_thread_id",a[0]),e[25]=new d.Map(),e[25].set("restore_context",e[24]),e[25].set("failure",e[23]),e[26]=e[25].get("restore_context"),e[25],e[27]=e[26].get("act_thread_id"),e[26],e[28]=d.toJSON(e[25]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[27]].join(""),d.i64.cast([0,50031]),e[28],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0]))):(e[23]=new d.Map(),e[23].set("error_code",d.i64.cast([0,100])),e[23].set("error_message",""),e[23].set("stored_procedure","issueMessageRangeQueryTask"),e[24]=new d.Map(),e[24].set("act_thread_id",a[0]),e[24].set("source",g),e[24].set("restore_operation_type",d.i64.cast([0,2])),e[25]=new d.Map(),e[25].set("restore_context",e[24]),e[25].set("failure",e[23]),e[26]=e[25].get("restore_context"),e[25],e[27]=e[26].get("act_thread_id"),e[26],e[28]=d.toJSON(e[25]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[27]].join(""),d.i64.cast([0,50030]),e[28],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0])))},function(c){return e[22]="threak pk not found for jid",e[22]!==g?d.seq([function(c){return e[26]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",e[22]].join(""),function(a){d.logger(a).mustfix(a)}(e[26]),e[23]=d.createArray(),a[4]!==g?e[27]=(e[23].push(a[4]),e[23]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",e[22],e[23],d.i64.cast([0,3]))},function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),e[26],g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[27]=a[0],a})},function(a){return e[27]?e[28]=!0:e[28]=!1,e[28]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[29]=d.createArray(),g!==g?e[30]=(e[29].push(g),e[29]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[29],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[24]=a[0],a})},function(a){return e[24]?e[25]=!0:e[25]=!1,e[25]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[27]=d.createArray(),g!==g?e[28]=(e[27].push(g),e[27]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[27],d.i64.cast([0,3]))):d.resolve()}]):d.seq([function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[25]=a[0],a})},function(a){return e[25]?e[26]=!0:e[26]=!1,e[26]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[27]=d.createArray(),g!==g?e[28]=(e[27].push(g),e[27]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[27],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[23]=a[0],a})},function(a){return e[23]?e[24]=!0:e[24]=!1,e[24]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[25]=d.createArray(),g!==g?e[26]=(e[25].push(g),e[25]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[25],d.i64.cast([0,3]))):d.resolve()}])},function(a){return e[9]?e[21]=d.i64.cast([0,5]):e[21]=d.i64.cast([0,2])}])},function(a){return e[13]=!0}]):d.seq([function(c){return e[9]?(e[21]=new d.Map(),e[21].set("error_code",d.i64.cast([0,1])),e[21].set("error_message",""),e[21].set("stored_procedure","issueMessageRangeQueryTask"),e[22]=new d.Map(),e[22].set("act_thread_id",a[0]),e[23]=new d.Map(),e[23].set("restore_context",e[22]),e[23].set("failure",e[21]),e[24]=e[23].get("restore_context"),e[23],e[25]=e[24].get("act_thread_id"),e[24],e[26]=d.toJSON(e[23]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[25]].join(""),d.i64.cast([0,50031]),e[26],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0]))):(e[21]=new d.Map(),e[21].set("error_code",d.i64.cast([0,1])),e[21].set("error_message",""),e[21].set("stored_procedure","issueMessageRangeQueryTask"),e[22]=new d.Map(),e[22].set("act_thread_id",a[0]),e[22].set("source",g),e[22].set("restore_operation_type",d.i64.cast([0,2])),e[23]=new d.Map(),e[23].set("restore_context",e[22]),e[23].set("failure",e[21]),e[24]=e[23].get("restore_context"),e[23],e[25]=e[24].get("act_thread_id"),e[24],e[26]=d.toJSON(e[23]),d.sp(b("LSIssueNewTask"),["encrypted_backups_restore",":",e[25]].join(""),d.i64.cast([0,50030]),e[26],g,g,d.i64.cast([0,0]),d.i64.cast([0,0]),g,g,d.i64.cast([0,0]),d.i64.cast([0,0])))},function(c){return e[20]="backup not found",e[20]!==g?d.seq([function(c){return e[24]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",e[20]].join(""),function(a){d.logger(a).mustfix(a)}(e[24]),e[21]=d.createArray(),a[4]!==g?e[25]=(e[21].push(a[4]),e[21]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",e[20],e[21],d.i64.cast([0,3]))},function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),e[24],g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[25]=a[0],a})},function(a){return e[25]?e[26]=!0:e[26]=!1,e[26]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[27]=d.createArray(),g!==g?e[28]=(e[27].push(g),e[27]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[27],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[22]=a[0],a})},function(a){return e[22]?e[23]=!0:e[23]=!1,e[23]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[25]=d.createArray(),g!==g?e[26]=(e[25].push(g),e[25]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[25],d.i64.cast([0,3]))):d.resolve()}]):d.seq([function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[23]=a[0],a})},function(a){return e[23]?e[24]=!0:e[24]=!1,e[24]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[25]=d.createArray(),g!==g?e[26]=(e[25].push(g),e[25]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[25],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[21]=a[0],a})},function(a){return e[21]?e[22]=!0:e[22]=!1,e[22]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[23]=d.createArray(),g!==g?e[24]=(e[23].push(g),e[23]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[23],d.i64.cast([0,3]))):d.resolve()}])},function(a){return e[9]?e[19]=d.i64.cast([0,5]):e[19]=d.i64.cast([0,2]),e[13]=!1}])},function(a){return e[7]=e[13]}]))})):(c("gkx")("7350")||c("gkx")("4765"))&&c("justknobx")._("1103")?d.seq([function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[7]=a[0],a})},function(c){return e[7]?e[8]=!0:e[8]=!1,e[8]?d.seq([function(c){return a[4]!==g?d.seq([function(a){return d.islc(d.ftr(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))&&d.i64.eq(a.backupTenancy,d.i64.cast([0,2]))}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?e[28]=!1:(a.item,e[28]=!0)})},function(a){return e[28]?e[30]=d.i64.or_(d.i64.cast([0,73]),d.i64.cast([0,128])):e[30]=d.i64.cast([0,73]),e[32]="EncryptedBackups MCD Trace ID",e[33]=d.i64.to_string(e[30]),e[31]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",e[31],e[32],e[31],e[33]].join("")),d.resolve()},function(c){return d.sp(b("LSCreateDataTrace"),a[4],g,g,"restore_messages",e[30])},function(b){return e[27]=a[4]}]):d.seq([function(a){return d.islc(d.ftr(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))&&d.i64.eq(a.backupTenancy,d.i64.cast([0,2]))}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?e[28]=!1:(a.item,e[28]=!0)})},function(a){return e[28]?e[30]=d.i64.or_(d.i64.cast([0,73]),d.i64.cast([0,128])):e[30]=d.i64.cast([0,73]),d.nop(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,e[31]=a[0],a})},function(a){return e[35]="EncryptedBackups MCD Trace ID",e[36]=d.i64.to_string(e[30]),e[32]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",e[32],e[35],e[32],e[36]].join("")),d.resolve()},function(a){return d.sp(b("LSCreateDataTrace"),e[31],g,g,"restore_messages",e[30])},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]?e[34]=!0:e[34]=!1,e[34]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[37]=d.createArray(),g!==g?e[38]=(e[37].push(g),e[37]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[37],d.i64.cast([0,3]))):d.resolve()},function(a){return e[27]=e[31]}])},function(a){return e[9]=e[27]}]):d.seq([function(a){return d.islc(d.ftr(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))&&d.i64.eq(a.backupTenancy,d.i64.cast([0,2]))}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?e[27]=!1:(a.item,e[27]=!0)})},function(a){return e[27]?e[29]=d.i64.or_(d.i64.cast([0,73]),d.i64.cast([0,128])):e[29]=d.i64.cast([0,73]),d.nop(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[34]="EncryptedBackups MCD Trace ID",e[35]=d.i64.to_string(e[29]),e[31]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",e[31],e[34],e[31],e[35]].join("")),d.resolve()},function(a){return d.sp(b("LSCreateDataTrace"),e[30],g,g,"restore_messages",e[29])},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[32]=a[0],a})},function(a){return e[32]?e[33]=!0:e[33]=!1,e[33]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[36]=d.createArray(),g!==g?e[37]=(e[36].push(g),e[36]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[36],d.i64.cast([0,3]))):d.resolve()},function(a){return e[9]=e[30]}])},function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,1421]),d.i64.cast([0,2]),g,g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[10]=a[0],a})},function(a){return e[10]?e[11]=!0:e[11]=!1,e[11]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[27]=d.createArray(),g!==g?e[28]=(e[27].push(g),e[27]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[27],d.i64.cast([0,3]))):d.resolve()},function(a){return d.islc(d.ftr(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(a,c){var f=a.done;a=a.value;return f?(f=[g,g,g,g,g,d.i64.cast([0,1]),g,g,g,g,g,g,g,d.i64.cast([0,20])],e[12]=f[0],e[13]=f[1],e[14]=f[2],e[15]=f[3],e[16]=f[4],e[17]=f[5],e[18]=f[6],e[19]=f[7],e[20]=f[8],e[21]=f[9],e[22]=f[10],e[23]=f[11],e[24]=f[12],e[25]=f[13],f):(c=a.item,d.seq([function(a){return e[31]=c.backupTenancy,e[30]=c.encryptionVersion,d.i64.neq(g,g)?d.resolve(e[27]=g):d.seq([function(a){return e[32]=d.createArray(),d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,0])).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]?e[42]=(e[32].push(d.i64.cast([0,0])),e[32]):0,d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,2])).then(function(a){return a=a,e[34]=a[0],a})},function(a){return e[34]?e[42]=(e[32].push(d.i64.cast([0,2])),e[32]):0,d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,3])).then(function(a){return a=a,e[35]=a[0],a})},function(a){return e[35]?e[42]=(e[32].push(d.i64.cast([0,3])),e[32]):0,d.sp(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,4])).then(function(a){return a=a,e[36]=a[0],a})},function(a){return e[36]?e[42]=(e[32].push(d.i64.cast([0,4])),e[32]):0,e[37]=d.createArray(),e[38]=d.i64.of_int32(e[32].length),d.i64.gt(e[38],d.i64.cast([0,0]))?d.loopAsync(e[38],function(a){return e[42]=a,d.seq([function(a){return d.ntop("Array",b("LSArrayGetObjectAt"),e[32],e[42]).then(function(a){return a=a,e[43]=a[0],e[44]=a[1],a})},function(a){return e[45]=(e[37].push(e[43]),e[37])}])}):d.resolve()},function(a){return d.seq([function(a){return e[42]=d.createArray(),e[43]=d.i64.of_int32(e[37].length),d.i64.gt(e[43],d.i64.cast([0,0]))?d.loopAsync(e[43],function(a){return e[45]=a,d.seq([function(a){return d.ntop("Array",b("LSArrayGetObjectAt"),e[37],e[45]).then(function(a){return a=a,e[46]=a[0],e[47]=a[1],a})},function(a){return e[48]=(e[42].push(d.i64.to_string(e[46])),e[42])}])}):d.resolve()},function(a){return e[44]=e[42].join(","),e[39]=e[44]}])},function(a){return e[37].some(function(a){return d.i64.eq(e[30],a)})?e[40]=e[30]:e[40]=g,d.i64.neq(e[40],g)?e[41]=e[40]:e[41]=g,e[27]=e[41]}])},function(a){return d.i64.neq(e[27],g)?e[28]=e[27]:e[28]=d.i64.cast([0,0]),d.i64.neq(e[31],g)?e[29]=e[31]:e[29]=d.i64.cast([0,1]),a=[c.backupId,c.deviceId,c.mailboxRootKeyBlob,c.ocmfClientStateBlob,e[28],e[29],c.epochAuthPublicKeyBlob,c.epochAuthPrivateKeyBlob,c.devicePublicKeyBlob,c.devicePrivateKeyBlob,c.epochStoragePublicKeyBlob,c.epochStoragePrivateKeyBlob,c.obliviousValidationTokenBlob,c.authorityLevel],e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=a[3],e[16]=a[4],e[17]=a[5],e[18]=a[6],e[19]=a[7],e[20]=a[8],e[21]=a[9],e[22]=a[10],e[23]=a[11],e[24]=a[12],e[25]=a[13],a}]))})},function(c){return d.i64.neq(e[12],g)?d.blobs.neq(e[15],g)?d.seq([function(c){return d.i64.gt(a[1],d.i64.cast([0,0]))&&d.i64.gt(a[5],d.i64.cast([0,0]))?d.seq([function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,2515]),d.i64.cast([0,2]),g,g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[40]=a[0],a})},function(a){return e[40]?e[41]=!0:e[41]=!1,e[41]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[42]=d.createArray(),g!==g?e[43]=(e[42].push(g),e[42]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[42],d.i64.cast([0,3]))):d.resolve()}]):d.i64.gt(a[5],d.i64.cast([0,0]))?d.seq([function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,2514]),d.i64.cast([0,2]),g,g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[40]=a[0],a})},function(a){return e[40]?e[41]=!0:e[41]=!1,e[41]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[42]=d.createArray(),g!==g?e[43]=(e[42].push(g),e[42]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[42],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return d.nop(b("LSGetBlobFromString.nop"),a[0]).then(function(a){return a=a,e[27]=a[0],a})},function(a){return d.nop(b("LSHmac_v2.nop"),d.blob("dGhyZWFkX2lkX3Njb3Bl"),e[27]).then(function(a){return a=a,e[28]=a[0],a})},function(a){return d.nop(b("LSOcmfClientMap.nop"),e[15],e[28]).then(function(a){return a=a,e[29]=a[0],a})},function(a){return d.nop(b("LSBase64Encode.nop"),e[29]).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[39]=e[30]==null?"":e[30],d.nop(b("LSGetBlobFromString.nop"),d.i64.to_string(e[12])).then(function(a){return a=a,e[31]=a[0],a})},function(a){return d.nop(b("LSHmac_v2.nop"),d.blob("bWFpbGJveF9pZF9zY29wZQ=="),e[31]).then(function(a){return a=a,e[32]=a[0],a})},function(a){return d.nop(b("LSOcmfClientMap.nop"),e[15],e[32]).then(function(a){return a=a,e[33]=a[0],a})},function(a){return d.nop(b("LSBase64Encode.nop"),e[33]).then(function(a){return a=a,e[34]=a[0],a})},function(c){return d.blobs.neq(e[14],g)?d.seq([function(c){return a[2]!==g?d.seq([function(c){return e[41]=d.createArray(),e[47]=(e[41].push(d.i64.cast([0,32])),e[41]),d.nop(b("LSGetBlobFromString.nop"),["thread_ope_key","_",a[0]].join("")).then(function(a){return a=a,e[42]=a[0],a})},function(a){return d.nop(b("LSCreateDerivedKeys.nop"),e[42],g,e[14],e[41]).then(function(a){return a=a,e[43]=a[0],a})},function(a){return e[43]?e[44]=!1:e[44]=!0,e[44]?d.seq([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[47]=d.createArray(),g!==g?e[48]=(e[47].push(g),e[47]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",e[47],d.i64.cast([0,3]))},function(a){return e[45]=g}]):d.seq([function(a){return d.ntop("Array",b("LSArrayGetObjectAt"),e[43],d.i64.cast([0,0])).then(function(a){return a=a,e[47]=a[0],e[48]=a[1],a})},function(a){return e[45]=e[47]}])},function(c){return d.blobs.neq(e[45],g)?d.seq([function(c){return d.nop(b("LSGetBlobFromInt64BE.nop"),d.i64.from_string(a[2])).then(function(a){return a=a,e[47]=a[0],a})},function(a){return d.nop(b("LSTruncateSortKey.nop"),e[47]).then(function(a){return a=a,e[48]=a[0],a})},function(a){return d.nop(b("LSOpeEncrypt.nop"),e[45],e[48],d.i64.cast([0,16])).then(function(a){return a=a,e[49]=a[0],a})},function(a){return d.nop(b("LSBinaryToHex.nop"),e[49]).then(function(a){return a=a,e[50]=a[0],a})},function(a){return e[46]=e[50]==null?"":e[50]}]):d.seq([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] OPE key is null"),e[47]=d.createArray(),g!==g?e[48]=(e[47].push(g),e[47]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","OPE key is null",e[47],d.i64.cast([0,3]))},function(a){return e[46]=g}])},function(a){return e[40]=e[46]}]):d.resolve(e[40]=g)},function(a){return e[35]=e[40]}]):d.seq([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Mailbox root key is null"),e[40]=d.createArray(),g!==g?e[41]=(e[40].push(g),e[40]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Mailbox root key is null",e[40],d.i64.cast([0,3]))},function(a){return e[35]=g}])},function(c){return a[0]!==g?d.seq([function(c){return d.nop(b("LSGetThreadTransportIdFromThreadId.nop"),a[0]).then(function(a){return a=a,e[40]=a[0],a})},function(a){return d.i64.neq(e[40],g)?d.seq([function(a){return d.db.table(173).fetch([[[e[40]]],"jid"]).next().then(function(a,b){var c=a.done;a=a.value;return c?e[42]=g:(b=a.item,e[42]=b.serverThreadKey)})},function(a){return d.i64.neq(e[42],g)?e[44]=d.i64.to_string(e[42]):e[44]=g,e[41]=e[44]}]):d.seq([function(a){return function(a){d.logger(a).warn(a)}("[EncryptedBackups][MEBTableUtils] Failed to get server thread key, wa jid is null"),e[42]=d.createArray(),g!==g?e[43]=(e[42].push(g),e[42]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTableUtils","Failed to get server thread key, wa jid is null",e[42],d.i64.cast([0,2]))},function(a){return e[41]=g}])},function(a){return e[36]=e[41]}]):d.seq([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTableUtils] Failed to get server thread key, thread id is null"),e[40]=d.createArray(),g!==g?e[41]=(e[40].push(g),e[40]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTableUtils","Failed to get server thread key, thread id is null",e[40],d.i64.cast([0,3]))},function(a){return e[36]=g}])},function(c){return d.nop(b("LSGetThreadTransportIdFromThreadId.nop"),a[0]).then(function(a){return a=a,e[37]=a[0],a})},function(c){return d.sp(b("LSIssueRestoreTask"),e[34]==null?"":e[34],e[39],a[1],d.i64.cast([0,1]),e[35],e[9],a[3],a[5],a[2],e[36],e[37]).then(function(a){return a=a,e[38]=a[0],a})},function(b){return d.i64.neq(e[38],g)?d.db.table(180).add({taskId:e[38],listId:e[39],threadId:a[0]}):d.resolve()}]):(e[27]="Missing ocmf_client_state for IssueMessageRangeQueryTask",e[27]!==g?d.seq([function(a){return e[31]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",e[27]].join(""),function(a){d.logger(a).mustfix(a)}(e[31]),e[28]=d.createArray(),e[9]!==g?e[32]=(e[28].push(e[9]),e[28]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",e[27],e[28],d.i64.cast([0,3]))},function(a){return e[9]!==g?d.seq([function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,85]),d.i64.cast([0,2]),e[31],g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[32]=a[0],a})},function(a){return e[32]?e[33]=!0:e[33]=!1,e[33]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[34]=d.createArray(),g!==g?e[35]=(e[34].push(g),e[34]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[34],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[9]!==g?d.nop(b("LSFlushDataTrace.nop"),e[9]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]?e[30]=!0:e[30]=!1,e[30]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[32]=d.createArray(),g!==g?e[33]=(e[32].push(g),e[32]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[32],d.i64.cast([0,3]))):d.resolve()}]):d.seq([function(a){return e[9]!==g?d.seq([function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[30]?e[31]=!0:e[31]=!1,e[31]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[32]=d.createArray(),g!==g?e[33]=(e[32].push(g),e[32]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[32],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[9]!==g?d.nop(b("LSFlushDataTrace.nop"),e[9]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[28]=a[0],a})},function(a){return e[28]?e[29]=!0:e[29]=!1,e[29]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[30]=d.createArray(),g!==g?e[31]=(e[30].push(g),e[30]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[30],d.i64.cast([0,3]))):d.resolve()}])):(e[27]="Missing backup_id for IssueMessageRangeQueryTask",e[27]!==g?d.seq([function(a){return e[31]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",e[27]].join(""),function(a){d.logger(a).mustfix(a)}(e[31]),e[28]=d.createArray(),e[9]!==g?e[32]=(e[28].push(e[9]),e[28]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",e[27],e[28],d.i64.cast([0,3]))},function(a){return e[9]!==g?d.seq([function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,85]),d.i64.cast([0,2]),e[31],g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[32]=a[0],a})},function(a){return e[32]?e[33]=!0:e[33]=!1,e[33]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[34]=d.createArray(),g!==g?e[35]=(e[34].push(g),e[34]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[34],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[9]!==g?d.nop(b("LSFlushDataTrace.nop"),e[9]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]?e[30]=!0:e[30]=!1,e[30]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[32]=d.createArray(),g!==g?e[33]=(e[32].push(g),e[32]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[32],d.i64.cast([0,3]))):d.resolve()}]):d.seq([function(a){return e[9]!==g?d.seq([function(a){return e[9]!==g?d.sp(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[30]?e[31]=!0:e[31]=!1,e[31]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[32]=d.createArray(),g!==g?e[33]=(e[32].push(g),e[32]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[32],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[9]!==g?d.nop(b("LSFlushDataTrace.nop"),e[9]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[28]=a[0],a})},function(a){return e[28]?e[29]=!0:e[29]=!1,e[29]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[30]=d.createArray(),g!==g?e[31]=(e[30].push(g),e[30]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[30],d.i64.cast([0,3]))):d.resolve()}]))}]):(e[7]="paged restore is disabled",e[7]!==g?d.seq([function(c){return e[11]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",e[7]].join(""),function(a){d.logger(a).mustfix(a)}(e[11]),e[8]=d.createArray(),a[4]!==g?e[12]=(e[8].push(a[4]),e[8]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",e[7],e[8],d.i64.cast([0,3]))},function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),e[11],g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[12]=a[0],a})},function(a){return e[12]?e[13]=!0:e[13]=!1,e[13]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[14]=d.createArray(),g!==g?e[15]=(e[14].push(g),e[14]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[14],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[9]=a[0],a})},function(a){return e[9]?e[10]=!0:e[10]=!1,e[10]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[12]=d.createArray(),g!==g?e[13]=(e[12].push(g),e[12]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[12],d.i64.cast([0,3]))):d.resolve()}]):d.seq([function(c){return a[4]!==g?d.seq([function(c){return a[4]!==g?d.sp(b("LSAppendDataTraceAddon"),a[4],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),g):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[10]=a[0],a})},function(a){return e[10]?e[11]=!0:e[11]=!1,e[11]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[12]=d.createArray(),g!==g?e[13]=(e[12].push(g),e[12]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[12],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(c){return a[4]!==g?d.nop(b("LSFlushDataTrace.nop"),a[4]):d.resolve()},function(a){return d.sp(b("LSIsMobileClient")).then(function(a){return a=a,e[8]=a[0],a})},function(a){return e[8]?e[9]=!0:e[9]=!1,e[9]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[10]=d.createArray(),g!==g?e[11]=(e[10].push(g),e[10]):0,d.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[10],d.i64.cast([0,3]))):d.resolve()}]))},function(a){return e[1]=d.i64.of_float(Date.now()),e[2]=d.i64.random(),e[4]="Finishing execution. Execution time: ",e[5]=d.i64.to_string(d.i64.sub(e[1],e[0])),e[6]=" ms",e[3]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ",e[3],e[4],e[3],e[5],e[3],e[6]].join("")),d.i64.eq(d.i64.mod_(e[2],d.i64.cast([0,100])),d.i64.cast([0,0]))?(e[7]=",",e[8]=d.createArray(),g!==g?e[9]=(e[8].push(g),e[8]):0,d.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",[e[4],e[7],e[5],e[7],e[6]].join(""),e[8],d.i64.cast([0,4]))):d.resolve()}])},function(a){return d.resolve(f)}])}d=a;g["default"]=d}),98);
__d("LSIssueMessageRangeQueryTaskStoredProcedure",["LSIssueMessageRangeQueryTask"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadId;d[1]=b.numMessages;d[2]=b.startSortKey;d[3]=b.isPointQuery;d[4]=b.traceId;d[5]=b.newerNumMessages;return c("LSIssueMessageRangeQueryTask").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MWEncryptedBackupsIssueRangeQuery",["I64","LSEncryptedBackupsBackupTenancy","LSFactory","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","MAWEncryptedBackupUtils","MAWUIThreadCache","Promise","WAJids","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,e,f,g,k){if(c("gkx")("7110")){c("promiseDone")(d("MAWEncryptedBackupUtils").getBackupTenancy(a).then(function(l){if(l!=null&&(i||(i=d("I64"))).equal(l,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION)))return d("MAWUIThreadCache").getThreadJidByChatId({threadId:e}).then(function(e){if(e==null)return(h||(h=b("Promise"))).resolve();else return a.runInTransaction(function(a){return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),{isPointQuery:!1,newerNumMessages:k,numMessages:g,startSortKey:(i||(i=d("I64"))).to_string(f),threadId:d("WAJids").threadIdForChatJid(e)})},"readwrite")});else return(h||(h=b("Promise"))).resolve()}));return}}g.runQuery=a}),98);
__d("MWCMCreateSubthreadMenuItem.react",["fbt","I64","Int64Hooks","LsFalcoEventEntryPoint","MWXMenuItem.react","react","requireDeferred","useMWCMCreateSubthread","useOpenSubthreadView"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react"),l=c("requireDeferred")("LsMessageActionFalcoEvent").__setRef("MWCMCreateSubthreadMenuItem.react"),m=h._("__JHASH__BJS3T2_tOPf__JHASH__"),n=h._("__JHASH__ZHBRqixJ9Qy__JHASH__");function a(a){var b=a.message;a=c("useMWCMCreateSubthread")(b);var e=a[0];a=a[1];var f=c("useOpenSubthreadView")(),g=b.subthreadKey,h=d("Int64Hooks").useCallbackInt64(function(){l.onReady(function(a){return a.log(function(){var a={};return{action:{container_module:"MWCMCreateSubthreadMenuItem",type:g!=null?105:104},error:{message:void 0},extra:a,message:{attachment_type:"",entry_point:d("LsFalcoEventEntryPoint").messageActions,id:b.messageId,recipient_id:void 0},thread:{group_size:(j||(j=d("I64"))).to_string(j.zero),id:j.to_string(b.threadKey),type:18}}})}),g!=null?f(g):void e()},[b.messageId,b.threadKey,e,f,g]);return k.jsx(c("MWXMenuItem.react"),{"aria-label":g!=null?n:m,disabled:a,onClick:h,primaryText:g!=null?n:m})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWLSMessageReportingToken",["I64","Int64Hooks"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("Int64Hooks").useMemoInt64(function(){return window.btoa("message_thread:"+(h||(h=d("I64"))).to_string(b)+":"+a)},[a,b])}g["default"]=a}),98);
__d("cometMessengerFileUploadComposerPluginSupportedTypes",[],(function(a,b,c,d,e,f){"use strict";a=["photo","video","file"];b=a;f["default"]=b}),66);
__d("useCometMessengerFileUploadPaste",["react","useCometLexicalFileDragAndDrop"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(a){var b=a.editor,d=a.handlePastedFiles;a=a.isMimeTypeAcceptable;var e=i(function(a){a.length>0&&d(a)},[d]);c("useCometLexicalFileDragAndDrop")({editor:b,isMimeTypeAcceptable:a,onSubmit:e})}g["default"]=a}),98);
__d("CometMessengerHandlePastedFileComposerPlugin",["cometIsMimeTypeForMedia","cometMessengerFileUploadComposerPluginSupportedTypes","useCometMessengerFileUploadPaste"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a.kind!=="file")return!1;for(var b=c("cometMessengerFileUploadComposerPluginSupportedTypes"),e=Array.isArray(b),f=0,b=e?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;switch(g){case"photo":if(d("cometIsMimeTypeForMedia").isMimeTypeForPhoto(a.type))return!0;break;case"video":if(d("cometIsMimeTypeForMedia").isMimeTypeForVideo(a.type))return!0;break;case"file":if(d("cometIsMimeTypeForMedia").isMimeTypeForFile(a.type))return!0;break;default:g}}return!1}function a(a){var b=a.editor;a=a.handlePastedFiles;c("useCometMessengerFileUploadPaste")({editor:b,handlePastedFiles:a,isMimeTypeAcceptable:h});return null}g["default"]=a}),98);
__d("MWOpenMediaManagerUtils",["fbt","I64","LSFactory","LSGenerateTraceId","LSIntEnum","LSMarkSubJobCompletedV2StoredProcedure","MWConsole","MWPComposerMediaUploadUtil","MWPOpenComposerUtils","OfflineThreadingId","Promise","ReQL","asyncToGeneratorRuntime","emptyFunction","justknobx","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k;function a(a){return(k||(k=b("Promise"))).resolve(d("OfflineThreadingId").createForItemsInOrder(a))}function e(a,e,f,g,j,m,n,o,p,q){j===void 0&&(j=c("emptyFunction"));m===void 0&&(m=c("emptyFunction"));n===void 0&&(n=c("emptyFunction"));var r=function(b,e){e=e.event;if(!e.lengthComputable)return;var f=e.loaded/e.total;c("promiseDone")(a.runInTransaction(function(a){return d("MWPOpenComposerUtils").updateMediaStaging(a,b,function(a){return babelHelpers["extends"]({},a,{progress:f})})},"readwrite"))},s=function(j,o){if(o==null){var p="";if(!c("justknobx")._("899"))return;c("promiseDone")(a.runInTransaction(function(a){return d("MWPOpenComposerUtils").deleteMediaStaging(a,j).then(function(){return l(a,j)}).then(function(){var a=f.find(function(a){return a[1]===j});a!=null&&a[0].type==="application/zip"?(g(h._("__JHASH__Tgh_5naYWqz__JHASH__"),h._("__JHASH__rp1B2ks3qwV__JHASH__")),p="null_fbid_invalid_file_format"):(g(h._("__JHASH__stZga-a6f____JHASH__")),p="null_fbid_other")})},"readwrite"),function(){return n(p,j)});return}c("promiseDone")(a.runInTransaction(function(a){var f=d("MWPOpenComposerUtils").updateMediaStaging(a,j,function(a){return babelHelpers["extends"]({},a,{fbid:(i||(i=d("I64"))).of_float(o),progress:1})}),g=a.table("media_send_jobs").get(j).then(function(f){if(f==null)return(k||(k=b("Promise"))).resolve();var g=c("LSFactory")(a),h=f.offlineThreadingId,l=f.offlineAttachmentId;return c("LSMarkSubJobCompletedV2StoredProcedure")(g,{fbid:(i||(i=d("I64"))).of_float(o),offlineAttachmentId:j}).then(function(){return d("MWPOpenComposerUtils").deleteMediaStaging(a,j)}).then(function(){return d("MWPOpenComposerUtils").updateAttachment(a,e,h,l,function(a){return babelHelpers["extends"]({},a,{attachmentFbid:o.toString()})})}).then(function(){return d("MWPOpenComposerUtils").resumeSendJob(g,h,c("LSGenerateTraceId")())})});return(k||(k=b("Promise"))).all([f,g])},"readwrite"),function(){return m(j)})},t=function(b,e){c("promiseDone")(a.runInTransaction(function(a){return d("MWPOpenComposerUtils").updateMediaStaging(a,b,function(a){return babelHelpers["extends"]({},a,{hasError:!0})}).then(function(){return l(a,b)})},"readwrite"),function(){var a;n((a=e.response.getErrorDescriptionString())!=null?a:"unknown_upload_failure",b)})},u=f.map(function(a){return a[1]}),v=f.map(function(a){return a[0]});return d("MWPComposerMediaUploadUtil").startUpload(j,r,s,t,void 0,v,u,o,p,void 0,q)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield a.table("media_send_jobs").get(b));if(b==null)return;b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("messages").index("optimistic")).getKeyRange(b.offlineThreadingId)));if(b==null)return;b=babelHelpers["extends"]({},b,{sendStatusV2:(j||(j=d("LSIntEnum"))).ofNumber(4)});yield a.table("messages").put(b)});return m.apply(this,arguments)}g.preprocess=a;g.upload=e}),98);
__d("MWPinnedMessagesDialogNUXFactoryRequireNUX.react",["nux:345"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("nux:345")==null?void 0:b("nux:345")("WEB_MSGR_PINNED_MESSAGES_NUX")};c=a;g["default"]=c}),98);
__d("useMWPinnedMessageLimitReached",["ReQL","ReQLSuspense","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i=50;function a(a){var b=(h||(h=c("useReStore")))(),e=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(b.table("msg_pinned_messages_v2")).getKeyRange(a)},[b,a],f.id+":29").length;return e>=i}g["default"]=a}),98);
__d("LSOptimisticSetPinnedMessage",["LSIssueNewTaskWithExtraOperations","LSSetPinnedMessage"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(d){return c.i64.eq(a[3],c.i64.cast([0,2]))?c.sp(b("LSSetPinnedMessage"),a[0],a[1],a[2],c.i64.cast([0,1])):c.sp(b("LSSetPinnedMessage"),a[0],a[1],a[2],a[3])},function(e){return c.i64.eq(a[3],c.i64.cast([0,2]))?(d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("message_id",a[1]),d[0].set("timestamp_ms",a[2]),d[0].set("pinned_location",c.i64.cast([0,1])),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTaskWithExtraOperations"),["pin_msg_v2","_",c.i64.to_string(d[1])].join(""),c.i64.cast([0,430]),d[2],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,c.i64.cast([0,0]),f,c.i64.cast([0,0]))):c.i64.eq(a[3],c.i64.cast([0,1]))?(d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("message_id",a[1]),d[0].set("timestamp_ms",a[2]),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTaskWithExtraOperations"),["pin_msg_v2","_",c.i64.to_string(d[1])].join(""),c.i64.cast([0,430]),d[2],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,c.i64.cast([0,0]),f,c.i64.cast([0,0]))):c.i64.eq(a[3],c.i64.cast([0,0]))?(d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("message_id",a[1]),d[0].set("timestamp_ms",a[2]),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTaskWithExtraOperations"),["unpin_msg_v2","_",c.i64.to_string(d[1])].join(""),c.i64.cast([0,431]),d[2],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,c.i64.cast([0,0]),f,c.i64.cast([0,0]))):c.resolve(0)}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSOptimisticSetPinnedMessageStoredProcedure",["LSOptimisticSetPinnedMessage"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.messageId;d[2]=b.pinnedTimestampMs;d[3]=b.state;return c("LSOptimisticSetPinnedMessage").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSPinnedMessageState",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_PINNED:0,PINNED:1,PINNED_AND_FEATURED:2});f["default"]=a}),66);
__d("useMWTogglePinMessage",["I64","LSFactory","LSOptimisticSetPinnedMessageStoredProcedure","LSPinnedMessageState","MWPActor.react","MWPBumpEntityKey","ServerTime","asyncToGeneratorRuntime","promiseDone","react","requireDeferred","useMWPIsMessagePinned","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(j||d("react")).useCallback,l=c("requireDeferred")("MWLogMessageAction").__setRef("useMWTogglePinMessage");function a(a,e){var f=(h||(h=c("useReStore")))(),g=c("useMWPIsMessagePinned")(a),j=a.messageId,m=a.threadKey,n=d("ServerTime").getMillis(),o=d("MWPActor.react").useActor(),p=function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield f.runInTransaction(function(b){var h=g?c("LSPinnedMessageState").NOT_PINNED:c("LSPinnedMessageState").PINNED,k=g?"unpin":"pin";e==="message_dot_menu"?l.onReady(function(b){return c("promiseDone")(b.log(f,a.messageId,m,e,k,void 0,void 0,void 0,a.senderId,void 0,o))}):k==="unpin"&&e==="pinned_message_list_dot_menu"&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_pinned_messages","unpin");return c("LSOptimisticSetPinnedMessageStoredProcedure")(c("LSFactory")(b),{messageId:j,pinnedTimestampMs:(i||(i=d("I64"))).of_int32(n),state:i.of_int32(h),threadKey:m})},"readwrite")});return function(){return h.apply(this,arguments)}}();return k(p,[f,g,j,(i||(i=d("I64"))).to_string(m),n])}g["default"]=a}),98);
__d("MWPinMessageMenuItem.react",["fbt","JSResourceForInteraction","MWPinnedMessagesDialogNUXFactoryRequireNUX.react","MWXMenuItem.react","promiseDone","react","useMWPIsMessagePinned","useMWPinnedMessageLimitReached","useMWTogglePinMessage","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=c("JSResourceForInteraction")("MWPinnedMessageLimitReachedDialog.react").__setRef("MWPinMessageMenuItem.react");function a(a){var b=a.message,d=a.onPinCompleted,e=h._("__JHASH__SDjIWKr-fud__JHASH__"),f=h._("__JHASH__mSiYCxxiHcw__JHASH__"),g=c("useMWPIsMessagePinned")(b),i=c("MWPinnedMessagesDialogNUXFactoryRequireNUX.react")();a=c("useMWXLazyDialog")(k);var l=a[0],m=c("useMWTogglePinMessage")(b,"message_dot_menu"),n=c("useMWPinnedMessageLimitReached")(b.threadKey);a=function(a){return i!=null?i({children:a,dialogProps:{onClose:function(){},pinMessageHandler:function(){return c("promiseDone")(m(),d)}}}):j.jsx(j.Fragment,{children:a(function(){return c("promiseDone")(m(),d)})})};var o=function(a){return j.jsx(c("MWXMenuItem.react"),{onClick:function(d){if(n&&!g)return l({onClose:function(){},threadKey:b.threadKey});!g?a():c("promiseDone")(m())},primaryText:g?f:e})};return a(o)}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWEditMenuItem.react",["fbt","MAWEditMessageContext.react","MWPActor.react","MWPReplyContext.react","MWXMenuItem.react","logMAWEditMessage","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext;function a(a){var b=a.message,e=a.threadType;a=k(d("MAWEditMessageContext.react").Context);var f=a.setEditMessageData;a=k(d("MWPReplyContext.react").MWPReplyContext);var g=a.clearReply,i=a.reply,l=d("MWPActor.react").useActor();a=h._("__JHASH__645ugDJYeSD__JHASH__");return j.jsx(c("MWXMenuItem.react"),{"aria-label":a,onClick:function(){i!=null&&g(b.threadKey,!0),f({messageId:b.messageId,threadKey:b.threadKey,timestampMs:b.timestampMs}),c("logMAWEditMessage")(e,b.threadKey,l,89)},primaryText:a,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2CreatePromptMenuItem.react",["fbt","CometRelay","JSResourceForInteraction","MWDidQueryPromptsNux","MWShowMessagePromptPopoverContext.react","MWV2CreatePromptMenuItemQuery.graphql","MWXMenuItem.react","MessengerWebUXLogger","promiseDone","react","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l=c("JSResourceForInteraction")("MWCommunityMessagingPromptsNUXQuickPromotion.react").__setRef("MWV2CreatePromptMenuItem.react");function m(){var a=d("CometRelay").useRelayEnvironment();return function(){return d("CometRelay").fetchQuery(a,i!==void 0?i:i=b("MWV2CreatePromptMenuItemQuery.graphql"),{}).toPromise()}}function a(){var a=d("MWShowMessagePromptPopoverContext.react").useMWShowMessagePromptPopoverContext(),b=a[0],e=c("MessengerWebUXLogger")==null?void 0:c("MessengerWebUXLogger").useInteractionLogger();a=c("useMWXLazyDialog")(l);var f=a[0],g=m();a=function(){b.current==null?void 0:b.current(),d("MWDidQueryPromptsNux").getDidQueryPromptsNux()||(d("MWDidQueryPromptsNux").markDidQueryPromptsNux(),c("promiseDone")(g(),function(a){a=a==null?void 0:(a=a.viewer)==null?void 0:(a=a.eligible_promotions)==null?void 0:(a=a.nodes)==null?void 0:(a=a.find(function(a){return((a=a.comet_qp_sections)==null?void 0:a.renderer_strategy)!=null}))==null?void 0:(a=a.comet_qp_sections)==null?void 0:a.renderer_strategy;a&&f({asCreator:!0,rendererStrategy:a})})),e==null?void 0:e({eventName:"message_create_prompt"})};return k.jsx(c("MWXMenuItem.react"),{onClick:a,primaryText:h._("__JHASH__HlC08Cr4XB6__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2ForwardMenuItem.react",["fbt","LSMessagingThreadTypeUtil","MWXMenuItem.react","react","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=a.message;a=a.threadType;var e=d("LSMessagingThreadTypeUtil").isSecure(a);e=c("useMWV2MessageForwardAction")(e,b,a);b=h._("__JHASH__GvPr2MwluxY__JHASH__");return j.jsx(c("MWXMenuItem.react"),{"aria-label":b,onClick:e,primaryText:b,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSDeleteMessageStoredProcedure",["LSDeleteMessage"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.messageId;return c("LSDeleteMessage").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MWV2RemoveMenuItem.react",["fbt","I64","Int64Hooks","JSResourceForInteraction","LSDeleteMessageStoredProcedure","LSFactory","LSIntEnum","LSMessagingThreadTypeUtil","MWCMIsAnyCMThread","MWCMThreadTypes.react","MWPActor.react","MWV2LogMessageClick","MWV2OnlyGlobalRemoveMessageDialog.entrypoint","MWXMenuItem.react","MessengerWebUXLogger","WebUserFlowLoggingDataContextProvider.react","gkx","promiseDone","react","useMWXEntryPointDialog","useMWXLazyDialog","useReStore","uuidv4"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||(l=d("react"));b=l;var n=b.useContext,o=b.useRef,p=c("JSResourceForInteraction")("MWV2RemoveMessageDialog.react").__setRef("MWV2RemoveMenuItem.react");function a(a){var b=a.canRemoveMessageGlobally,e=a.learnMoreOnMessageRemove,f=a.message,g=a.onRemoveMessageLogger,l=a.threadType;a=a.title;var q=(i||(i=c("useReStore")))(),r=h._("__JHASH__xWxZXNnPg5R__JHASH__"),s=f.messageId,t=f.threadKey,u=c("MWCMIsAnyCMThread")(l)&&(j||(j=d("I64"))).equal(f.sendStatusV2,(k||(k=d("LSIntEnum"))).ofNumber(4)),v=d("Int64Hooks").useCallbackInt64(function(){c("promiseDone")(q.runInTransaction(function(a){return c("LSDeleteMessageStoredProcedure")(c("LSFactory")(a),{messageId:s,threadKey:t})},"readwrite"))},[q,t,s]),w=o(null),x=d("MWPActor.react").useActor(),y=(j||(j=d("I64"))).equal(f.senderId,x),z={learnMoreOnMessageRemove:e,message:f,title:a},A={canRemoveMessageGlobally:b,learnMoreOnMessageRemove:e,message:f,removeLogger:g,threadType:l,title:a},B=c("MessengerWebUXLogger")==null?void 0:c("MessengerWebUXLogger").useInteractionLogger();x=n(d("WebUserFlowLoggingDataContextProvider.react").WebUserFlowLoggingDataContext);var C=x.setLoggingData;b=c("useMWXEntryPointDialog")(c("MWV2OnlyGlobalRemoveMessageDialog.entrypoint"),{});var D=b[0];e=c("useMWXLazyDialog")(p);var E=e[0],F=function(){d("MWCMThreadTypes.react").isJoinedCMThread(l)||d("LSMessagingThreadTypeUtil").isDiscoverableChannel(l)||y&&!c("gkx")("9197")?D(z):E(A)};return m.jsx(c("MWXMenuItem.react"),{"aria-label":r,onClick:function(){var a={extraData:{actor_type:y?"sender":"receiver"},flowInstanceId:c("uuidv4")(),threadKey:t,threadType:l};B==null?void 0:B(babelHelpers["extends"]({},a,{eventName:"message_remove_attempt"}));C(a);d("MWV2LogMessageClick").log(q,f,45);return f.subscriptErrorMessage!=null&&u?v():F()},primaryText:h._("__JHASH__hqbvAdrkmFp__JHASH__"),ref:w,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2ReplyMenuItem.react",["fbt","MWPReplyContext.react","MWXMenuItem.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext;function a(a){a=a.message;var b=a;a=h._("__JHASH__xFCj85w6vra__JHASH__");var e=k(d("MWPReplyContext.react").MWPReplyContext),f=e.setReply;return j.jsx(c("MWXMenuItem.react"),{"aria-label":a,onClick:function(){return f({messageId:b.messageId,offlineThreadingId:b.offlineThreadingId,sendStatusV2:b.sendStatusV2,timestampMs:b.timestampMs},b.threadKey)},primaryText:a,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("FRXEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({ACTIVITY_LOG:"activity_log",AGORA_GROUPS:"agora_groups",AGORA_RECENT_NEWS:"agora_recent_news",BLOCK_BUTTON:"block_button",BLOCK_COMPOSER:"block_composer",BUSINESS_NOTIFICATION_MESSAGE_REPORT_BUTTON:"business_notification_message_report_button",CHEVRON_BUTTON:"chevron_button",CHEVRON_TAGS:"chevron_tags",COLLEGES_LIVE_CHAT_REPORT_TO_FB:"colleges_live_chat_report_to_fb",COMMENT:"comment",CONTENT_OVERLAY:"content_overlay",CROWDSOURCING_REPORT:"crowdsourcing_report",DELETE_CONTENT_REPORT:"delete_content_report",DELETE_CONVERSATION_REPORT:"delete_conversation_report",DEVELOPER_FEEDBACK_BUTTON:"developer_feedback_button",EVENTS_REPORTING:"events_reporting",FEEDBACK_BUTTON:"feedback_button",FOX_CHEVRON_TAGS:"fox_chevron_tags",GEMSTONE_MEDIA:"gemstone_media",GEMSTONE_MESSAGING:"gemstone_messaging",GEMSTONE_PROFILE:"gemstone_profile",GROUP_MALL_RELATED_GROUPS_CHAINING:"group_mall_related_groups_chaining",GROUP_MALL_RHC:"group_mall_rhc",GROUPS_ADMIN_FEEDBACK:"groups_admin_feedback",GROUPS_DISCOVER:"groups_discover_page",GROUPS_DISCOVER_HIDE_BUTTON:"groups_discover_hide_button",GROUPS_JOIN_QUESTION:"groups_join_question",GROUPS_LEAVE:"groups_leave",GROUPS_LEAVE_BROWSE:"groups_leave_browse",GROUPS_LEAVE_SPECIAL:"groups_leave_special",GROUPS_PARTICIPATION_QUESTION:"groups_participation_question",GROUPS_PENDING_QUEUE:"groups_pending_queue",GROUPS_POLL:"groups_poll",GROUPS_REPORT:"groups_report",GROUPS_REPORT_LONG_PRESS_TO_ADMIN:"groups_report_long_press_to_admin",GROUPS_REPORT_TO_ADMIN:"groups_report_to_admin",GROUPS_RULE:"groups_rule",GROUPS_TAB_CHAT_ROW:"groups_tab_chat_row",GROUPS_TAB_DISCOVER_FIRST:"groups_tab_discover_first",GROUPS_TRANSPARENCY:"groups_transparency",HATE_CTA:"hate_cta",HELP_NAV_BUTTON:"help_nav_button",HIDE_AD_BUTTON:"hide_ad_button",HIDE_AD_XOUT_BUTTON:"hide_ad_xout_button",IN_PROFILE_MEDIA_SELECTOR:"in_profile_media_selector",INSTANT_GAMES_BOT_FEEDBACK_LINK:"instant_games_bot_feedback_link",LEAVE_CONVERSATION_REPORT:"leave_conversation_report",LOCAL_COMMUNITY_DEMOTE_CONTENT:"local_community_demote_content",LOCAL_COMMUNITY_MOD_HUB_DEMOTE:"local_community_mod_hub_demote",LOCAL_COMMUNITY_POST_REPORT_TO_MOD:"local_community_post_report_to_mod",LOCAL_LIVE_CHAT_REPORT_TO_FB:"local_live_chat_report_to_fb",MARK_AS_SOLD_BUTTON:"mark_as_sold_button",MARK_AS_SUSPICIOUS_BUTTON:"mark_as_suspicious_button",MESSAGE_MEDIA_BUBBLE_REPORT:"message_media_bubble_report",MOBILE_GYSJ:"mobile_gysj",NOTIFICATIONS_JEWEL:"notifications_jewel",PAGE_UNFOLLOW:"page_unfollow",PAGE_UNFOLLOW_CHEVRON:"page_unfollow_chevron",PAGE_UNLIKE:"page_unlike",PAGE_VERIFICATION_BADGE_OPTION:"page_verification_badge_option",PAGE_VERIFICATION_PAGE_OPTION:"page_verification_page_option",POLITICAL_AD_VERIFIED_VOICE:"political_ad_verified_voice",PROACTIVE_WARNING_BANNER:"proactive_warning_banner",PROACTIVE_WARNING_COMPOSER_BLOCK:"proactive_warning_composer_block",PROACTIVE_WARNING_POPOVER:"proactive_warning_popover",PROACTIVE_WARNING_STRAP:"proactive_warning_strap",PROFILE_REPORT_BUTTON:"profile_report_button",PROFILE_REPORT_FLOW:"profile_report_flow",PROFILE_SUBMIT_FEEDBACK:"profile_submit_feedback",QUICK_REPORT_ACTION:"quick_report_action",RELATED_SEARCHES:"related_searches",REPORT_AD_BUTTON:"report_ad_button",REPORT_AD_XOUT_BUTTON:"report_ad_xout_button",REPORT_BUTTON:"report_button",REPORT_BUTTON_DETAILED_FRX:"report_button_detailed_frx",REPORT_FROM_PREVIEW:"report_from_preview",REPORT_JOB_BUTTON:"report_job_button",REPORT_LONG_PRESS:"report_long_press",ROOMS_POST_CALL_HIGH_RATING:"rooms_post_call_high_rating",ROOMS_POST_CALL_LOW_RATING:"rooms_post_call_low_rating",ROOMS_POST_CALL_LOW_RATING_DETAILED:"rooms_post_call_low_rating_detailed",SCHOOL_COMMUNITY_TAGS:"school_community_tags",SEARCH_TYPEAHEAD:"search_typeahead",SNACKBAR:"snackbar",STORY_ATTACHMENT_SHARE:"story_attachment_share",STRUCTURED_REPORT_BUTTON:"structured_report_button",THREADLIST_MENU_REPORT:"threadlist_menu_report",TOMBSTONE:"tombstone",TOOLBAR_REPORT_ACTION:"toolbar_report_action",UNKNOWN:"unknown",UNOWNED_PAGE_ACTION_MENU_REPORT_PAGE:"unowned_page_action_menu_report_page",UPSELL_AFTER_BLOCK_BOTTOM_SHEET:"upsell_after_block_bottom_sheet",USER_CONTROL_MENU:"user_control_menu",WORKPLACE_REPORT_AND_HIDE_BUTTON:"workplace_report_and_hide_button",WORKPLACE_REPORT_BUTTON:"workplace_report_button",WORKROOM_REPORT_BUTTON:"workroom_report_button",X_OUT:"x_out"});f["default"]=a}),66);
__d("useMWXPushToast",["CometIcon.react","mwPushToast","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||c("react"),k=(h||(h=d("react"))).useCallback;function a(){return k(function(a){d("mwPushToast").mwPushToast(babelHelpers["extends"]({},a,{icon:a.icon?{comet:j.jsx(c("CometIcon.react"),{icon:a.icon.component}),mds:a.icon.component}:void 0}))},[])}g["default"]=a}),98);
__d("useReStoreIfAvailable",["useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return(h||(h=c("useReStore")))()}g["default"]=a}),98);
__d("useMWV2ReportMessage.react",["fbt","I64","LSFactory","LSIntEnum","LSInternetConnectionState","LSReportMessageInCommunityChannel","ReQL","asyncToGeneratorRuntime","promiseDone","react","useMWXConfirmationDialog","useMWXPushToast","useReStoreIfAvailable"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=(i||d("react")).useCallback;function a(a,e){var f=c("useReStoreIfAvailable")(),g=c("useMWXConfirmationDialog")(),i=(j||(j=d("I64"))).isI64(a)?a:(j||(j=d("I64"))).of_string(a),m=c("useMWXPushToast")(),n=l(function(){if(f==null)return;c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield f.runInTransaction(function(a){return c("LSReportMessageInCommunityChannel")(i,e,c("LSFactory")(a))},"readwrite");var a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(f.table("connectivity_status"))));a!=null&&(j||(j=d("I64"))).equal(a.internetConnectionState,(k||(k=d("LSIntEnum"))).ofNumber(c("LSInternetConnectionState").CONNECTED))&&m({body:h._("__JHASH__d_L8PCP9wn0__JHASH__")})})())},[f,i,e,m]);a=l(function(){return g({body:h._("__JHASH__N-iMIiU3yyg__JHASH__"),confirm:h._("__JHASH__m9ILY9EaLLQ__JHASH__"),title:h._("__JHASH__ZQlRxOvru63__JHASH__")},n)},[g,n]);return a}g["default"]=a}),98);
__d("MWV2ReportMessageMenuItem.react",["fbt","CometFRX.entrypoint","MWXMenuItem.react","qex","react","useMWLSMessageReportingToken","useMWV2ReportMessage.react","useMWXEntryPointDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=a.isSubthread;b=b===void 0?!1:b;a=a.message;var d=c("useMWLSMessageReportingToken")(a.messageId,a.threadKey);d=c("useMWXEntryPointDialog")(c("CometFRX.entrypoint"),{entryPoint:"groups_report_long_press_to_admin",id:d,location:b?"messenger_community_messaging_subthread_view":"messenger_community_messaging_group_thread_details"});var e=d[0];b=c("useMWV2ReportMessage.react")(a.threadKey,a.messageId);d=h._("__JHASH__Un1168J6Rxb__JHASH__");a=(a=c("qex")._("73"))!=null?a:!1;return j.jsx(c("MWXMenuItem.react"),{"aria-label":d,onClick:a?function(){return e({})}:b,primaryText:d,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2ReportMessageToFBMenuItem.react",["CometFRX.entrypoint","MWXMenuItem.react","react","useMWLSMessageReportingToken","useMWXEntryPointDialog"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.isSubthread;b=b===void 0?!1:b;var d=a.menuItemLabel,e=a.messageId,f=a.onReportLogger;a=a.threadKey;e=c("useMWLSMessageReportingToken")(e,a);a={entryPoint:"report_long_press",id:e,location:b?"messenger_community_messaging_subthread_view":"messenger_community_messaging_group_thread_details"};var g={};e=a;b=c("useMWXEntryPointDialog")(c("CometFRX.entrypoint"),e);var h=b[0],j=function(){return h(g)};return i.jsx(c("MWXMenuItem.react"),{"aria-label":d,onClick:function(){f&&f(),j()},primaryText:d})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWPCanUserEditMessage",["I64","LSAuthorityLevel","LSHotEmojiSize","LSIntEnum","LSMessagingThreadTypeUtil","MWCMIsAnyCMThread","MWCMIsCMSubthread","MWCMThreadTypes.react","MWPActor.react","ReQL","ReQLSuspense","gkx","qex","useReStore","useServerTime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=5,l=(j||(j=d("I64"))).of_int32(15*60);function m(a,b){a=(j||(j=d("I64"))).of_float(a/1e3);b=j.div(b,j.of_int32(1e3));a=j.sub(a,b);return j.lt(a,l)}function a(a,b){var e,g,l=d("MWPActor.react").useActor(),o=(h||(h=c("useReStore")))(),p=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(o.table("attachments")).getKeyRange(a.threadKey,a.messageId)},[o,a.messageId,a.threadKey],f.id+":61"),q=c("useServerTime")();if(b==null)return!1;e=(j||(j=d("I64"))).to_int32((e=a.editCount)!=null?e:(j||(j=d("I64"))).zero)<k;q=m(q.getTime(),a.timestampMs);l=j.equal(a.senderId,l);var r=a.text!=null&&a.text!=="";g=j.equal((g=a.hotEmojiSize)!=null?g:(j||(j=d("I64"))).zero,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").NONE));p=((p=p==null?void 0:p.hasXma)!=null?p:!1)||a.mentionIds!=null;var s=a.isUnsent===!1&&(j||(j=d("I64"))).equal(a.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE));return e&&q&&l&&r&&g&&!p&&s&&n(b)}function n(a){var b=a.threadType;if(d("LSMessagingThreadTypeUtil").isWorkThread(a.threadSubtype))return!1;if(d("LSMessagingThreadTypeUtil").isSecure(b))return c("gkx")("8016");if(d("MWCMThreadTypes.react").isBroadcastThread(b)||d("LSMessagingThreadTypeUtil").isJoinedDiscoverablePublicBroadcastChannel(b)){var e;return(e=c("qex")._("303"))!=null?e:!1}if(c("MWCMIsAnyCMThread")(b)||c("MWCMIsCMSubthread")(b)){return(e=c("qex")._("305"))!=null?e:!1}if(d("LSMessagingThreadTypeUtil").isOpenFnFThread(a)){return(b=c("gkx")("9293")||c("qex")._("306"))!=null?b:!1}return!1}g["default"]=a}),98);
__d("MWV2ContextualActionsMenu.react",["fbt","LSMessagingThreadTypeUtil","MAWEditMenuItem.react","MWChatMessageBothOrientationFocusGroup.react","MWMessageRowActions.react","MWPinMessageMenuItem.react","MWV2CreatePromptMenuItem.react","MWV2ForwardMenuItem.react","MWV2RemoveMenuItem.react","MWV2ReplyMenuItem.react","MWV2ReportMessageMenuItem.react","MWV2ReportMessageToFBMenuItem.react","MWXMenu.react","MWXPopover.react","WebUXLoggingSurfaceContextProvider","cr:1111","cr:1200","cr:1787","cr:4140","cr:5750","cr:5790","cr:6088","focusScopeQueries","react","useMWEntrypoint","useMWFalcoFeatureEventLogger","useMWPCanUserEditMessage"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var e=a.canRemoveMessageGlobally;a.closeActionsMenu;var f=a.extraActions,g=a.learnMoreDialogType,i=a.learnMoreOnMessageRemove,k=a.message;a.onClose;var l=a.onRemoveMessageLogger,m=a.removeMessageDialogTitle,n=a.showCreatePrompt,o=a.showCreateSubthread,p=a.showFeedbackOptionsInContextualMenu,q=a.showForwardActionInContextualMenu,r=a.showLearnMoreInContextualMenu,s=a.showPinMessageActionInContextualMenu,t=a.showReplyActionInContextualMenu,u=a.showReportCommunityMessageToAdmin,v=a.showReportCommunityMessageToFacebook,w=a.showUnsendInContextualMenu;a=a.thread;var x=c("useMWEntrypoint")(),y=a==null?void 0:a.threadType,z=c("useMWFalcoFeatureEventLogger")(k.threadKey,y),A=h._("__JHASH__xVGUtEB2kuN__JHASH__");a=c("useMWPCanUserEditMessage")(k,a);return j.jsx(c("MWXPopover.react"),{withArrow:!0,children:j.jsx(d("MWChatMessageBothOrientationFocusGroup.react").keyCommands,{children:j.jsx(d("MWChatMessageBothOrientationFocusGroup.react").FocusGroup,{allowModifiers:!0,orientation:"both",preventScrollOnFocus:!1,tabScopeQuery:d("focusScopeQueries").tabbableScopeQuery,children:j.jsx(c("MWXMenu.react"),{label:A,size:"full",children:j.jsxs(d("WebUXLoggingSurfaceContextProvider").WebUXLoggingSurfaceContextProvider,{value:"thread_view_message_options",children:[a?j.jsx(c("MAWEditMenuItem.react"),{message:k,threadType:y}):null,w?j.jsx(c("MWV2RemoveMenuItem.react"),{canRemoveMessageGlobally:e,learnMoreOnMessageRemove:i,message:k,onRemoveMessageLogger:l,threadType:y,title:m}):null,q?j.jsx(c("MWV2ForwardMenuItem.react"),{message:k,threadType:y}):null,b("cr:6088")&&r&&g&&g===d("MWMessageRowActions.react").LearnMoreDialogType.AI_STICKERS?j.jsx(b("cr:6088"),{dialogType:g}):null,t?j.jsx(c("MWV2ReplyMenuItem.react"),{message:k}):null,b("cr:5750")!=null&&o?j.jsx(b("cr:5750"),{message:k}):null,n?j.jsx(c("MWV2CreatePromptMenuItem.react"),{}):null,s?j.jsx(c("MWPinMessageMenuItem.react"),{message:k,onPinCompleted:function(){z(x,"pin_message")}}):null,u?j.jsx(c("MWV2ReportMessageMenuItem.react"),{message:k}):null,v?j.jsx(c("MWV2ReportMessageToFBMenuItem.react"),{isSubthread:d("LSMessagingThreadTypeUtil").isCMSubthread(y),menuItemLabel:h._("__JHASH__2SjbZXVdFlO__JHASH__"),messageId:k.messageId,threadKey:k.threadKey}):null,b("cr:5790")?j.jsx(b("cr:5790"),{message:k}):null,b("cr:1200")!=null&&p&&j.jsx(b("cr:1200"),{message:k}),b("cr:1111")!=null&&p&&j.jsx(b("cr:1111"),{message:k}),f,b("cr:4140")?j.jsxs(j.Fragment,{children:[b("cr:1787")&&j.jsx(b("cr:1787"),{}),j.jsx(b("cr:4140"),{message:k})]}):null]})})})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWPinnedMessagesDialogNUXFactory.react",["JSResourceForInteraction","MWInboxPersistedUIState","declareNUXRequireable","react","useMWXLazyDialog","useSharedNUX"],(function(a,b,c,d,e,f,g){"use strict";var h;h||(h=d("react"));b=h;var i=b.useCallback,j=b.useMemo,k=c("JSResourceForInteraction")("MWPinnedMessagesDialogNUX.react").__setRef("MWPinnedMessagesDialogNUXFactory.react");function a(a){return function(b){var e=b.children,f=b.dialogProps;b=c("useSharedNUX")(a);var g=b[0],h=b[1];b=d("MWInboxPersistedUIState").usePersistedUIState(void 0,"__MWSimpleNux."+a+"__");b[0];var l=b[1],m=i(function(){l(void 0),h.onDismiss()},[h,l]),n=j(function(){return{onDismiss:m,pinMessageHandler:f.pinMessageHandler}},[f,m]);b=c("useMWXLazyDialog")(k);var o=b[0];b=function(){return o(n)};return g?e(b):e(f.pinMessageHandler)}}e=c("declareNUXRequireable")(a);g["default"]=e}),98);
__d("MlsMessageActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1401");b=d("FalcoLoggerInternal").create("mls_message_action",a);e=b;g["default"]=e}),98);
__d("MWLogMessageAction",["I64","MWLSContactTypeExactUtils","MlsMessageActionFalcoEvent","ReQL","asyncToGeneratorRuntime","coerceMessagingThreadTypeToLSThreadType"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,d,e,f,g,h,j,k,l){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i,j,k,l,m,n){var o,p=(yield (o=d("ReQL")).firstAsync(o.fromTableAscending(a.table("threads")).getKeyRange(e))),q=(yield o.toArrayAsync(o.fromTableAscending(a.table("participants")).getKeyRange(e))),r=(yield o.firstAsync(o.mergeJoin(o.fromTableAscending(a.table("participants")).getKeyRange(e),o.fromTableAscending(a.table("contacts"))).filter(function(a){a[0];a=a[1].contactTypeExact;return d("MWLSContactTypeExactUtils").isIgContact(a)})))!=null;p!=null&&c("MlsMessageActionFalcoEvent").log(function(){var a;return{action:g,browser_window_height:window.innerHeight,browser_window_width:window.innerWidth,device_screen_height:window.screen.height,device_screen_width:window.screen.width,error_text:j,extra:i,group_size:String(q.length),is_xac_thread:r,ls_thread_type:c("coerceMessagingThreadTypeToLSThreadType")(p.threadType),message_type:(a=m)!=null?a:"text",mid:b,reaction:k,recipient_id:l!=null?(h||(h=d("I64"))).to_string(l):void 0,sender_id:(h||(h=d("I64"))).to_string(n),source:f,thread_id:h.to_string(e)}})});return i.apply(this,arguments)}g.log=a}),98);
__d("ZenonUserActionLoggerCommon",["cr:11085"],(function(a,b,c,d,e,f,g){"use strict";g.logClick=b("cr:11085").logClick,g.logImpression=b("cr:11085").logImpression}),98);
__d("LsMessageClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1743853");b=d("FalcoLoggerInternal").create("ls_message_click",a);e=b;g["default"]=e}),98);
__d("MessageThreadEventsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5034");b=d("FalcoLoggerInternal").create("message_thread_events",a);e=b;g["default"]=e}),98);
__d("MessengerDiscoverableBroadcastChatsClientEventsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4148");b=d("FalcoLoggerInternal").create("messenger_discoverable_broadcast_chats_client_events",a);e=b;g["default"]=e}),98);
__d("MessengerDiscoverableChatClientEventsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1254");b=d("FalcoLoggerInternal").create("messenger_discoverable_chat_client_events",a);e=b;g["default"]=e}),98);/*FB_PKG_DELIM*/
__d("LSReportMessageInCommunityChannelImpl",["LSIssueNewError","LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(a){return c.sb(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=!1:(b=a.item,d[0]=b.errorShouldBeShown)})},function(a){return d[0]===!0?c.seq([function(a){return c.localizeV2Async(c.i64.cast([0,2285622730]),f).then(function(a){return d[7]=a})},function(a){return c.localizeV2Async(c.i64.cast([0,1919524925]),f).then(function(a){return d[8]=a})},function(a){return c.sp(b("LSIssueNewError"),f,c.i64.cast([0,1545093]),d[7],d[8],f,f)}]):c.resolve()},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("message_id",a[1]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[7]=c.i64.of_float(Date.now()),d[3]=c.i64.add(d[7],c.i64.cast([0,0]))):d[3]=c.i64.cast([0,0]),d[4]=d[2].get("thread_key"),d[2],d[5]=c.toJSON(d[2]),c.sp(b("LSIssueNewTaskAndGetTaskID"),c.i64.to_string(d[4]),c.i64.cast([0,374]),d[5],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,d[3],c.i64.cast([0,0])).then(function(a){return a=a,d[6]=a[0],a})}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSReportMessageInCommunityChannel",["LSReportMessageInCommunityChannelImpl"],(function(a,b,c,d,e,f,g){g["default"]=c("LSReportMessageInCommunityChannelImpl")}),98);/*FB_PKG_DELIM*/
__d("MWRelayLogSend",["I64","MessageSendsClientFalcoEvent","MultipleTabsLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=a.attachmentFbids,e=a.attachmentType,f=a.backend,g=a.hasReply,i=a.initatingSource,j=a.messagingThreadId,k=a.msgTtl,l=a.offlineThreadingId,m=a.participantIds,n=a.sendType,o=a.source,p=a.threadKey,q=a.threadType;c("promiseDone")(d("MultipleTabsLogger").hasMultipleTabs().then(function(a){var r=m,s=j!=null?j:(h||(h=d("I64"))).to_string(p),t=k!=null?(h||(h=d("I64"))).to_string((h||(h=d("I64"))).of_float(k)):void 0;c("MessageSendsClientFalcoEvent").log(function(){return{backend:f,event_type:n,feature_tags:a===!0?[19]:[],group_thread_subtype:void 0,igd_action:void 0,igd_target_type:void 0,igd_verb:void 0,initiating_app_id:void 0,initiating_source:i,is_reply:g,message_attachment_fbids:b.map(String),message_id:void 0,message_type:e,messaging_thread_fbid:s,messaging_thread_type:(h||(h=d("I64"))).to_int32(q),msg_ttl:t,nav_chain:void 0,nonce:void 0,offline_threading_id:l,recipient_fbids:r,send_attribution:h.to_int32(o),send_attribution_raw:void 0,view_mode:void 0}})}))}g["default"]=a}),98);